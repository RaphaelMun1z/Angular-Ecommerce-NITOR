<div class="bg-white rounded-3xl border border-gray-100 p-6 lg:p-10 animate-fade-in relative">
        
        <div class="border-b border-gray-100 pb-8 mb-8 flex flex-col sm:flex-row items-center justify-between gap-6">
            <div class="flex items-center gap-5 text-center sm:text-left flex-col sm:flex-row">
                <div class="relative group">
                    <div class="w-24 h-24 rounded-2xl overflow-hidden border-4 border-gray-50 shadow-sm transition-all"
                         [class.ring-2]="isUploading()" [class.ring-brand-500]="isUploading()" [class.opacity-50]="isUploading()">
                        <img [src]="user().avatar" class="w-full h-full object-cover" (error)="handleImageError($event)">
                    </div>
                    
                    @if (isEditingMode()) {
                      <label class="absolute inset-0 bg-black/40 rounded-2xl flex items-center justify-center transition-opacity cursor-pointer opacity-0 group-hover:opacity-100">
                          @if (isUploading()) {
                              <i class="ph-bold ph-spinner animate-spin text-white text-2xl"></i>
                          } @else {
                              <i class="ph-bold ph-camera text-white text-2xl"></i>
                          }
                          <input type="file" class="hidden" accept="image/*" (change)="onAvatarSelected($event)" [disabled]="isUploading()">
                      </label>
                    }
                </div>

                <div>
                    <h2 class="text-2xl font-bold text-gray-900 tracking-tight">Informações Pessoais</h2>
                    <p class="text-sm text-gray-500 mt-1 font-medium">Gerencie sua identidade e dados de contato no sistema.</p>
                </div>
            </div>

            <div class="flex gap-3">
                @if (!isEditingMode()) {
                    <button (click)="toggleEditing()" 
                            class="px-5 py-2.5 rounded-xl border border-gray-200 text-gray-700 font-bold text-sm hover:bg-gray-50 hover:border-gray-300 transition-all flex items-center gap-2 cursor-pointer">
                        <i class="ph-bold ph-pencil-simple"></i>
                        Editar Dados
                    </button>
                } @else {
                    <button (click)="cancelEditing()" 
                            class="px-5 py-2.5 rounded-xl text-gray-500 font-bold text-sm hover:text-red-600 transition-all cursor-pointer">
                        Cancelar
                    </button>
                    <button (click)="savePersonalData($event)" 
                            [disabled]="isSaving()"
                            class="px-6 py-2.5 rounded-xl bg-gray-900 text-white font-bold text-sm shadow-sm hover:bg-black transition-all flex items-center gap-2 cursor-pointer disabled:opacity-50">
                        @if (isSaving()) { <i class="ph-bold ph-spinner animate-spin"></i> }
                        Salvar Alterações
                    </button>
                }
            </div>
        </div>
        
        <form (submit)="savePersonalData($event)" class="space-y-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                
                <div class="space-y-2">
                    <label class="block text-[11px] font-bold text-gray-400 uppercase tracking-widest ml-1">E-mail de Acesso</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                            <i class="ph-bold ph-envelope-simple text-lg text-gray-300"></i>
                        </div>
                        <input type="email" [value]="user().email" disabled 
                               class="w-full bg-gray-50 border border-gray-100 text-gray-400 font-medium text-sm rounded-2xl py-3.5 pl-12 pr-4 cursor-not-allowed">
                    </div>
                </div>
                
                <div class="space-y-2">
                    <label class="block text-[11px] font-bold text-gray-500 uppercase tracking-widest ml-1"
                           [class.text-brand-600]="isEditingMode()">Nome Completo</label>
                    <div class="relative group">
                        <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                            <i class="ph-bold ph-user text-lg transition-colors" 
                               [class.text-brand-500]="isEditingMode()" [class.text-gray-300]="!isEditingMode()"></i>
                        </div>
                        <input type="text" [(ngModel)]="formData.nome" name="nome" [disabled]="!isEditingMode()"
                               [class.bg-white]="isEditingMode()" [class.bg-gray-50]="!isEditingMode()"
                               class="w-full border border-gray-100 text-gray-900 font-semibold text-sm rounded-2xl py-3.5 pl-12 pr-4 focus:outline-none focus:border-brand-500 focus:ring-4 focus:ring-brand-500/5 transition-all outline-none">
                    </div>
                </div>
                
                @if (user().isCliente) {
                    <div class="space-y-2">
                        <label class="block text-[11px] font-bold text-gray-500 uppercase tracking-widest ml-1"
                               [class.text-brand-600]="isEditingMode()">CPF</label>
                        <div class="relative group">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="ph-bold ph-identification-card text-lg transition-colors"
                                   [class.text-brand-500]="isEditingMode()" [class.text-gray-300]="!isEditingMode()"></i>
                            </div>
                            <input type="text" [(ngModel)]="formData.cpf" name="cpf" mask="000.000.000-00" [disabled]="!isEditingMode()"
                                   [class.bg-white]="isEditingMode()" [class.bg-gray-50]="!isEditingMode()"
                                   class="w-full border border-gray-100 text-gray-900 font-semibold text-sm rounded-2xl py-3.5 pl-12 pr-4 focus:outline-none focus:border-brand-500 focus:ring-4 focus:ring-brand-500/5 transition-all outline-none">
                        </div>
                    </div>
                    
                    <div class="space-y-2">
                        <label class="block text-[11px] font-bold text-gray-500 uppercase tracking-widest ml-1"
                               [class.text-brand-600]="isEditingMode()">WhatsApp / Telefone</label>
                        <div class="relative group">
                            <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <i class="ph-bold ph-phone text-lg transition-colors"
                                   [class.text-brand-500]="isEditingMode()" [class.text-gray-300]="!isEditingMode()"></i>
                            </div>
                            <input type="text" [(ngModel)]="formData.telefone" name="telefone" mask="(00) 0 0000-0000" [disabled]="!isEditingMode()"
                                   [class.bg-white]="isEditingMode()" [class.bg-gray-50]="!isEditingMode()"
                                   class="w-full border border-gray-100 text-gray-900 font-semibold text-sm rounded-2xl py-3.5 pl-12 pr-4 focus:outline-none focus:border-brand-500 focus:ring-4 focus:ring-brand-500/5 transition-all outline-none">
                        </div>
                    </div>
                }
            </div>

            @if (isEditingMode()) {
              <div class="bg-amber-50/50 border border-amber-100 rounded-2xl p-4 flex items-start gap-4 animate-fade-in">
                  <div class="bg-amber-100 text-amber-600 p-2 rounded-xl shrink-0">
                      <i class="ph-fill ph-shield-check text-xl"></i>
                  </div>
                  <div>
                      <h4 class="text-xs font-bold text-amber-900 uppercase tracking-tight">Alteração de dados sensíveis</h4>
                      <p class="text-xs text-amber-700/80 mt-1 leading-relaxed">
                          Por motivos de segurança, o seu e-mail de acesso não pode ser alterado pelo painel. Se precisar mudar seu endereço eletrônico, entre em contato com nossa central de atendimento.
                      </p>
                  </div>
              </div>
            }
        </form>
    </div>