<div
  class="space-y-8 animate-fade-in pb-10 max-w-[1600px] mx-auto px-4 sm:px-6"
>
  <header
    class="flex flex-col md:flex-row md:items-center justify-between gap-4"
  >
    <div>
      <h1 class="text-2xl font-bold text-gray-900 tracking-tight">
        Gestão de Clientes
      </h1>
      <p class="text-sm text-gray-500 mt-0.5">
        Base de usuários e controle de acesso
      </p>
    </div>

    <div class="flex items-center gap-2">
      <button
        routerLink="/dashboard-admin/relatorios-administrativos"
        class="p-2.5 text-gray-500 hover:text-gray-900 hover:bg-white rounded-xl transition-all cursor-pointer border border-transparent hover:border-gray-200"
        title="Relatórios"
      >
        <i class="ph-bold ph-chart-line-up text-xl"></i>
      </button>
      <button
        routerLink="/dashboard-admin/registrar-cliente"
        class="bg-brand-600 text-white text-sm font-bold px-5 py-2.5 rounded-xl hover:bg-brand-700 transition-all shadow-sm active:scale-[0.98] cursor-pointer flex items-center gap-2"
      >
        <i class="ph-bold ph-user-plus"></i>
        Novo Cliente
      </button>
    </div>
  </header>

  <section class="flex flex-col md:flex-row gap-4 items-center justify-between">
    <div class="relative w-full md:max-w-sm group">
      <i
        class="ph ph-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-brand-500 transition-colors"
      ></i>
      <input
        type="text"
        [ngModel]="searchTerm()"
        (ngModelChange)="onSearch($event)"
        placeholder="Buscar por nome, e-mail ou CPF..."
        class="w-full pl-10 pr-4 py-2 bg-transparent border-b border-gray-200 focus:border-brand-500 transition-all outline-none text-sm text-gray-700 placeholder:text-gray-400"
      />
    </div>

    <div
      class="flex items-center gap-1 overflow-x-auto scrollbar-hide w-full md:w-auto"
    >
      <button
        class="px-4 py-1.5 rounded-lg text-xs font-bold transition-all cursor-pointer whitespace-nowrap text-brand-600 bg-brand-50"
      >
        Todos
      </button>
      <button
        class="px-4 py-1.5 rounded-lg text-xs font-bold transition-all cursor-pointer whitespace-nowrap text-gray-500 hover:text-gray-800 hover:bg-gray-100"
      >
        Ativos
      </button>
      <button
        class="px-4 py-1.5 rounded-lg text-xs font-bold transition-all cursor-pointer whitespace-nowrap text-gray-500 hover:text-gray-800 hover:bg-gray-100"
      >
        Bloqueados
      </button>
    </div>
  </section>

  <div
    class="bg-white rounded-2xl border border-gray-100 overflow-hidden relative min-h-[500px] shadow-sm flex flex-col"
  >
    @if (isLoading()) {
      <div
        class="absolute inset-0 bg-white/60 backdrop-blur-[2px] z-30 flex items-center justify-center text-brand-600"
      >
        <i class="ph ph-spinner animate-spin text-3xl"></i>
      </div>
    }

    <div class="overflow-x-auto flex-1">
      <table class="w-full text-left border-collapse">
        <thead>
          <tr
            class="text-[10px] text-gray-400 uppercase tracking-widest border-b border-gray-50 font-bold bg-gray-50/30"
          >
            <th class="px-6 py-4">Cliente / ID</th>
            <th class="px-6 py-4">Contato</th>
            <th class="px-6 py-4">Documento</th>
            <th class="px-6 py-4">Status</th>
            <th class="px-6 py-4 text-center w-24">Ações</th>
          </tr>
        </thead>
        <tbody class="text-sm divide-y divide-gray-50">
          @for (customer of customers(); track customer.id) {
            <tr class="hover:bg-gray-50/50 transition-colors group">
              <td class="px-6 py-5">
                <div class="flex items-center gap-4">
                  <div
                    class="w-12 h-12 rounded-xl bg-white border border-gray-200 flex items-center justify-center shrink-0 overflow-hidden relative group-hover:border-brand-200 transition-colors"
                  >
                    <img
                      [src]="
                        'https://ui-avatars.com/api/?name=' +
                        customer.nome +
                        '&background=f3f4f6&color=4b5563&size=128&font-size=0.4'
                      "
                      [alt]="customer.nome"
                      class="w-full h-full object-cover"
                    />
                  </div>
                  <div class="flex flex-col min-w-0">
                    <span
                      class="font-bold text-gray-900 truncate max-w-[200px]"
                      [title]="customer.nome"
                    >
                      {{ customer.nome }}
                    </span>
                    <div class="flex items-center gap-2 mt-0.5">
                      <span
                        class="text-[10px] font-mono text-gray-500 bg-gray-100 px-1.5 rounded border border-gray-200"
                      >
                        {{ customer.id.substring(0, 8) }}
                      </span>
                    </div>
                  </div>
                </div>
              </td>

              <td class="px-6 py-4">
                <div class="flex flex-col gap-0.5">
                  <span class="text-gray-700 font-medium text-sm">{{
                    customer.email
                  }}</span>
                  <div
                    class="flex items-center gap-1.5 text-[10px] text-gray-400 font-bold uppercase"
                  >
                    <i class="ph-bold ph-phone"></i>
                    {{
                      (customer.telefone || ""
                        | mask: "(00) 0000-0000 || (00) 00000-0000") || "---"
                    }}
                  </div>
                </div>
              </td>

              <td class="px-6 py-4">
                <span
                  class="font-mono text-[11px] text-gray-500 bg-gray-50 px-2 py-1 rounded-lg border border-gray-100 inline-block"
                >
                  {{ (customer.cpf || "" | mask: "000.000.000-00") || "---" }}
                </span>
              </td>

              <td class="px-6 py-4">
                <button
                  (click)="toggleStatus(customer)"
                  class="px-2 py-0.5 rounded-md text-[10px] font-bold border uppercase inline-flex items-center gap-1.5 transition-colors cursor-pointer"
                  [ngClass]="
                    true
                      ? 'text-green-600 bg-green-50 border-green-100 hover:bg-green-100'
                      : 'text-red-600 bg-red-50 border-red-100'
                  "
                >
                  <span class="w-1.5 h-1.5 rounded-full bg-green-500"></span>
                  Ativo
                </button>
              </td>

              <td class="px-6 py-4 text-center">
                <div
                  class="flex items-center justify-end gap-1 transition-all duration-200 translate-x-2"
                >
                  <button
                    [routerLink]="['/dashboard-admin/registrar-cliente']"
                    [queryParams]="{ id: customer.id }"
                    class="p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors cursor-pointer"
                    title="Editar"
                  >
                    <i class="ph-bold ph-pencil-simple"></i>
                  </button>

                  <button
                    (click)="deleteCustomer(customer)"
                    class="p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors cursor-pointer"
                    title="Remover"
                  >
                    <i class="ph-bold ph-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          } @empty {
            @if (!isLoading()) {
              <tr>
                <td colspan="5" class="px-6 py-24 text-center">
                  <div
                    class="flex flex-col items-center justify-center text-gray-400"
                  >
                    <div
                      class="w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mb-3"
                    >
                      <i class="ph-duotone ph-users text-3xl opacity-50"></i>
                    </div>
                    <p class="text-sm font-medium">
                      Nenhum cliente encontrado.
                    </p>
                    <button
                      (click)="onSearch('')"
                      class="mt-2 text-brand-600 text-xs font-bold hover:underline cursor-pointer"
                    >
                      Limpar filtros
                    </button>
                  </div>
                </td>
              </tr>
            }
          }
        </tbody>
      </table>
    </div>

    <footer
      class="px-6 py-4 border-t border-gray-50 flex flex-col sm:flex-row items-center justify-between gap-4 bg-white"
    >
      <div
        class="flex items-center gap-3 text-xs text-gray-500 order-2 sm:order-1"
      >
        <span>Mostrar</span>
        <select
          [ngModel]="pageSize()"
          (ngModelChange)="updatePageSize($event)"
          class="bg-gray-50 border border-gray-200 text-gray-900 text-xs rounded-lg focus:ring-brand-500 focus:border-brand-500 block p-1.5 outline-none cursor-pointer"
        >
          <option [value]="5">5</option>
          <option [value]="10">10</option>
          <option [value]="20">20</option>
          <option [value]="50">50</option>
        </select>
        <span>por página</span>
      </div>

      <div class="flex items-center gap-1 order-1 sm:order-2">
        <button
          (click)="changePage(currentPage() - 1)"
          [disabled]="currentPage() === 0 || isLoading()"
          class="px-3 py-1.5 rounded-lg text-gray-500 hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent transition-colors text-xs font-bold cursor-pointer"
        >
          Anterior
        </button>

        @for (page of visiblePages(); track page) {
          <button
            (click)="goToPage(page)"
            [class.bg-brand-600]="page === currentPage()"
            [class.text-white]="page === currentPage()"
            [class.text-gray-600]="page !== currentPage()"
            [class.hover:bg-gray-100]="page !== currentPage()"
            class="w-8 h-8 rounded-lg text-xs font-bold transition-all flex items-center justify-center cursor-pointer"
          >
            {{ page + 1 }}
          </button>
        }

        <button
          (click)="changePage(currentPage() + 1)"
          [disabled]="currentPage() >= totalPages() - 1 || isLoading()"
          class="px-3 py-1.5 rounded-lg text-gray-500 hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent transition-colors text-xs font-bold cursor-pointer"
        >
          Próxima
        </button>
      </div>

      <div
        class="text-[10px] text-gray-400 font-bold uppercase tracking-widest order-3"
      >
        Total de {{ totalElements() }} clientes
      </div>
    </footer>
  </div>
</div>
