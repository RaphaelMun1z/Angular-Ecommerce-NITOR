<main class="container mx-auto px-4 pt-28 pb-12 animate-fade-in min-h-screen">
    <app-title-section></app-title-section>

    <div class="flex flex-col lg:flex-row gap-8 items-start">
        <div class="w-full lg:w-2/3 space-y-6">
            <app-identification-section
                [userEmail]="userEmail()"
            ></app-identification-section>

            <app-delivery-address-section
                [addresses]="addresses()"
                [selectedAddressId]="selectedAddressId()"
                [showAddressForm]="showAddressForm()"
                [editingAddress]="editingAddress()"
                (selectAddress)="selectedAddressId.set($event)"
                (toggleForm)="toggleAddressForm()"
                (editAddress)="editAddress($event)"
                (deleteAddress)="deleteAddress($event)"
                (setAsPrimary)="setAsPrimary($event.id, $event.event)"
                (saveAddress)="handleAddressSave($event)"
            ></app-delivery-address-section>

            <app-delivery-options-section
                [hasAddressSelected]="!!selectedAddressId()"
                [(selectedShippingMethod)]="selectedShippingMethod"
            ></app-delivery-options-section>

            <app-payment-section
                [total]="total()"
                [(paymentMethod)]="paymentMethod"
            ></app-payment-section>
        </div>

        <div class="w-full lg:w-1/3 lg:sticky lg:top-24">
            <app-order-summary-section
                [cartItems]="cartItems()"
                [subtotal]="subtotal()"
                [total]="total()"
                [selectedShippingMethod]="selectedShippingMethod()"
                [selectedAddressId]="selectedAddressId()"
                [isLoading]="isLoading()"
                (confirm)="confirmarPedido()"
            ></app-order-summary-section>
        </div>
    </div>
</main>
