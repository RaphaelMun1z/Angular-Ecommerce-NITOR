<div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
    <h3 class="font-bold text-gray-900 mb-4">Resumo do Pedido</h3>

    <div class="max-h-60 overflow-y-auto space-y-3 mb-6 pr-2 scrollbar-thin">
        @for (item of cartItems(); track item.id) {
            <div class="flex gap-3">
                <div
                    class="w-12 h-12 bg-gray-50 rounded border border-gray-200 overflow-hidden shrink-0 flex items-center justify-center text-gray-300"
                >
                    <i class="ph-duotone ph-image text-xl"></i>
                </div>

                <div class="flex-1">
                    <p
                        class="text-xs font-bold text-gray-800 line-clamp-1"
                        [title]="item.nomeProduto"
                    >
                        {{ item.nomeProduto }}
                    </p>
                    <p class="text-[10px] text-gray-500">
                        Qtd: {{ item.quantidade }}
                    </p>
                </div>

                <span class="text-xs font-bold text-gray-900">
                    {{ item.subTotal | currency: "BRL" }}
                </span>
            </div>
        }
    </div>

    <div class="space-y-2 border-t border-gray-100 pt-4 mb-6">
        <div class="flex justify-between text-sm text-gray-600">
            <span>Subtotal</span>
            <span>{{ subtotal() | currency: "BRL" }}</span>
        </div>
        <div class="flex justify-between text-sm text-gray-600">
            <span>Frete</span>
            @if (selectedShippingMethod() === "economic") {
                <span class="text-green-600 font-medium">Grátis</span>
            } @else if (selectedShippingMethod() === "fast") {
                <span class="text-gray-900 font-medium">R$ 15,90</span>
            } @else {
                <span class="text-gray-400 text-xs">Calcular</span>
            }
        </div>
        <div
            class="flex justify-between items-center mt-2 pt-2 border-t border-dashed border-gray-200"
        >
            <span class="font-bold text-gray-900">Total</span>
            <span class="text-xl font-extrabold text-brand-600">
                {{ total() | currency: "BRL" }}
            </span>
        </div>
    </div>

    <button
        (click)="confirmarPedido()"
        [disabled]="
            isLoading() ||
            cartItems().length === 0 ||
            !selectedAddressId() ||
            !selectedShippingMethod()
        "
        class="w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed disabled:text-gray-500 text-white font-bold py-4 rounded-xl shadow-lg transition-all active:scale-[0.98] flex items-center justify-center gap-2"
    >
        @if (isLoading()) {
            <i class="ph-bold ph-spinner animate-spin text-lg"></i>
            <span>Processando...</span>
        } @else {
            <span>Pagar Agora</span>
            <i class="ph-bold ph-lock-key"></i>
        }
    </button>

    <p class="text-[10px] text-center text-gray-400 mt-3">
        Ao finalizar, você concorda com nossos termos de uso.
    </p>
</div>
